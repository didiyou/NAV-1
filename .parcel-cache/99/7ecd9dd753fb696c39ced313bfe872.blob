const $siteList = $('.siteList')
const $lastli = $siteList.find('li.last')
const x = localStorage.getItem('x')
const xObject = JSON.parse(x)
const hashMap = xObject || [{logo:'images/哔哩哔哩.png',logoType:'text',url:'https://bilibili.com/'},
{logo:'A',url:'https://www.apple.com.cn/'},
{logo:'B',url:"www.baidu.com"}
]
const simplifyUrl = (url)=>{
    return url.replace('https://','').replace('http://','').replace('www.','').replace('/','')
}
const render =()=>{
    $siteList.find('li:not(.last)').remove()
    hashMap.forEach(node=>{
        const $li = $(`<li>
        <a href="${node.url}">
        <div class='site'>
            <div class="log">
                ${node.logo[0]}
            </div>
            <div class="link">${simplifyUrl(node.url)}</div>
        </div>
        </a>
    </li>`).insertBefore($lastli)
    })    
    }   
render()

$('.addButton').on('click',()=>{
    let url = window.prompt("请添加网址：")
    if(url.indexOf('http')!==0){
        url = 'https://'+ url
    }
    hashMap.push({
        logo:url[0],
        url:url})
        render()
    })    
    window.onbeforeunload = ()=>{
        const string = JSON.stringify(hashMap)
        localStorage.setItem('x',string)
    }
      